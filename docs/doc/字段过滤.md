# 文件上传

## 引言

### 编写目的

​	为帮助后端开发人员规避文件上传时可能出现的错误。



### 预期读者

​	使用Java语言进行开发的后端开发人员。



## 一、文件接收

后台接收文件的参数类型为`MultipartFile`，以二进制文件流的方式接收文件。

关于MultipartFile（此处仅列出几个常用方法）：

1. 单文件：`MultipartFile file`，

   多文件（定义为数组形式）：`MultipartFile[] file`；

2. 判断是否为空：`file.isEmpty()`——文件为空；
3. 上传文件原文件名：`file.getOriginalFilename()`;
4. 转存文件：`file.transferTo(new File(filePath))`。

## 二、文件保存

1.上传文件时，对文件进行读取、写出操作，此处事例使用的工具类为Hutool工具类。

```
// 使用Hutool工具类读取流数据
InputStream inputStream = file.getInputStream();
ExcelReader reader = ExcelUtil.getReader(inputStream);
```

2.保存文件

```
// 创建writer，生成文件。filePath为文件保存路径，fileName为保存文件名
ExcelWriter writer = ExcelUtil.getWriter(filePath + "/" + fileName +".xlsx");
// 对要写出的行列数据或Bean数据封装
// List<String> row = CollUtil.newArrayList("a", "b", "c", "d");
List<Entity> entities = reader.readAll(Entity.class);
// 一次性将内容写出
writer.write(row);
```

3.关闭ExcelReader、ExcelWriter对象

```
// 关闭reader，释放内存
reader.close();
// 关闭writer，释放内存
writer.close();
```

