<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.pkaq.sys.user.mapper.UserMapper">
  <resultMap id="BaseResultMap" type="user" extends="common.resultMap">
    <result column="CODE" jdbcType="VARCHAR" property="code" />
    <result column="DEPT_ID" jdbcType="VARCHAR" property="deptId" />
    <result column="TEL" jdbcType="VARCHAR" property="tel" />
    <result column="EMAIL" jdbcType="VARCHAR" property="email" />
    <result column="ACCOUNT" jdbcType="VARCHAR" property="account" />
    <result column="PASSWORD" jdbcType="VARCHAR" property="password" />
    <result column="SALT" jdbcType="VARCHAR" property="salt" />
    <result column="AVATAR" jdbcType="VARCHAR" property="avatar" />
    <result column="NAME" jdbcType="VARCHAR" property="name" />
    <result column="NICK_NAME" jdbcType="VARCHAR" property="nickName" />
    <result column="REGISTER_IP" jdbcType="VARCHAR" property="registerIp" />
    <result column="GMT_REGISTER" jdbcType="TIMESTAMP" property="gmtRegister" />
    <result column="LAST_IP" jdbcType="VARCHAR" property="lastIp" />
    <result column="LAST_LOGIN" jdbcType="TIMESTAMP" property="lastLogin" />
    <result column="LOCKED" jdbcType="TINYINT" property="locked" />
  </resultMap>
  <!-- 获取包含权限列表的用户信息-->
  <resultMap id="UserWithRole" type="user" extends="BaseResultMap">
    <collection property="roles" column="{userId=id}" select="org.pkaq.sys.role.mapper.RoleMapper.selectByUserId" ofType="role"/>
  </resultMap>
  <!-- 获取包含模块 权限列表的用户信息-->
  <resultMap id="UserWithModuleAndRole" type="user" extends="BaseResultMap">
    <collection property="roles" column="{userId=id}" select="org.pkaq.sys.role.mapper.RoleMapper.selectByUserId" ofType="role"/>
    <collection property="modules" column="{userId=id}" select="org.pkaq.sys.module.mapper.ModuleMapper.getRoleModuleByUserId" ofType="module"/>
  </resultMap>

   <!-- 根据用户id获取包含权限列表的用户信息 -->
   <select id="getUserWithRoleById" resultMap="UserWithRole">
       select * from sys_user_info
       where id=#{userId}
   </select>
    <!-- 根据用户ID 获取包含模块 权限列表的用户信息-->
  <select id="getUserWithModuleAndRoleById" resultMap="UserWithModuleAndRole">
    select * from sys_user_info
    where id=#{userId}
  </select>
</mapper>